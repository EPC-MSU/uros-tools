Скрипт, который создает диск с файловой системой Байкала из апдейта.

Запускать на виртуальной машине Ubuntu


ВНИМАНИЕ: ВСЕ ДАННЫЕ НА ДИСКЕ БУДУТ УНИЧТОЖЕНЫ БЕЗ ПРЕДУПРЕЖДЕНИЯ.
Для работы скрипту нужно количество свободного места в директории выполнения чуть больше размера апдейта.
Требуется наличие readlink, mktemp, cpio, dd, zcat, mkfs.ext4, tune2fs, mount, umount, mkdir, chown, chmod, cp, rmdir, rm, partprobe на системе запуска скрипта.

Запустите скрипт с параметрами файла апдейта (например "update.swu") и диска (например "/dev/sdXX" - это должен быть диск, а не раздел диска; подставьте реальное устройство, соответствующее инициализируемому SSD):
./init.sh update.swu /dev/sdXX
Дождитесь конца выполнения скрипта и безопасно отключите диск от системы.

Замечание: во время распаковки апдейта в зависимости от используемой версии cpio скрипт может вывести ошибку, например:
"cpio: ssd.ext4.gz: checksum error (0x74e1366f4, should be 0x4e1366f4)"
Игнорируйте ее, это не ошибка неверной контрольной суммы (заметьте, что все hex-цифры кроме лишней первой совпадают).